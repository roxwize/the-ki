<body>
<link rel="stylesheet" href="./static/css/mainpage.css" />
<style>
body { text-align: center; 
  overflow-y: hidden;}
</style>
<!--[if IE]>
  <link rel="stylesheet" href="./static/css/mainpage-ie.css" />
<![endif]-->
<!--[if !IE]><!-->
<link rel="stylesheet" href="./static/css/mainpage-noie.css" />
<!--<![endif]-->
<!----------------------------------------->
<h1 class="shadow" id="wobble">Agent</h1>
<h3 class="shadow sub">This is a <span id="rainbow">cool test</span> for Microsoft Agent characters.</h3>
<h5 class="shadow sub">If you don't see them, you probably dont have MSAgent installed (or aren't on Internet Explorer).</h5>
<button id="begin">Start</button><br/>
<button id="hack">Destroy website</button>
<hr/>
<button id="hide">Hide</button><br/>
<label for="saytext">Say this:</label> <input type="text" id="saytext" style="width:50px"> <button id="saybtn">Go</button><br/>
<button id="ouch">Make a sound</button><br/>
<button id="cp">Add 1 to click multiplier</button>

      <script src="./static/js/fx.js"></script>
      
      <object id="AgentControl" width="0" height="0"
  classid="CLSID:D45FD31B-5C6E-11D1-9EC1-00C04FD7081F"
  codebase="#VERSION=2,0,0,0">
</object>

<object id="L&HTruVoice" width="0" height="0"
  classid="CLSID:B8F2846E-CE36-11D0-AC83-00C04FD97575"
  codebase="#VERSION=6,0,0,0">
</object>

<script language="JavaScript" type="text/javascript" type="text/javascript">
<!--//
/*
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'_/ Portions generated by MASH - Microsoft Agent Scripting Helper, version 7.5
'_/ by BellCraft Technologies, http://www.bellcraft.com/mash
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
*/

// * Character Objects
var Merlin;

// * Variables
var UsedChars;
var MerlinID;
var MerlinACS;
var MerlinLoaded;
var LoadReq;
var HideReq;

// * Initialize
UsedChars = "Merlin";

// * Merlin
MerlinID = "Merlin";
MerlinACS = "merlin.acs";
MerlinLoaded = false;


Window_OnLoad();
var visible = false;
var clicks = 0;
var mult = 1;

function appear() {
Merlin.TTSModeID = "\{CA141FD0-AC7F-11D1-97A3-006008273002\}";
		Merlin.MoveTo(471, 183);
		Merlin.Show();
		Merlin.Speak("What's up");
		Merlin.Speak("Click on me to make me do stuff");
		Merlin.Speak("or click on the buttons again to commence various joyous activities");
		visible = true;
}
function ifNotInit() {
	if (CheckLoadStatus() && !visible) {
		appear();
	}
}

document.getElementById("begin").onclick = function() {
	if (CheckLoadStatus()) {
		//AgentIntro();
		var head = document.getElementById("wobble");
		InitAgentCommands();
		head.innerHTML = "It works!";
		
		appear();
	}
}
document.getElementById("hack").onclick = function() {
	ifNotInit();
	AgentIntro();
}
document.getElementById("saybtn").onclick = function() {
	ifNotInit();
	Merlin.Speak(document.getElementById("saytext").value);
};
document.getElementById("hide").onclick = function() {
	Merlin.Hide();
	visible = false;
};
document.getElementById("ouch").onclick = function() {
	ifNotInit();
	SayOuch();
};
document.getElementById("cp").onclick = function() {
	ifNotInit();
	mult++;
};

function SayOuch() {
	Merlin.Speak("\\Chr=\"Monotone\"\\\\Map=\"\\Pit=131\\\\Spd=100\\Mare \\Pit=117\\\\Spd=80\\ree \\Pit=104\\\\Spd=70\\had \\Pit=117\\\\Spd=50\\a \\Pit=131\\\\Spd=130\\pe nis face\"=\"Mary had a penis face\"\\");
}

function Window_OnLoad() {
    // Purpose:  Runs automatically when page is loaded

    // * INSERT ANY NON-AGENT RELATED SCRIPTING HERE

    AgentControl.Connected = true;

    MerlinLoaded = LoadLocalChar(MerlinID, MerlinACS);

    if (!MerlinLoaded) {
        // Attempt to load default character
        MerlinLoaded = LoadLocalChar(MerlinID, "");
    }

    if (MerlinLoaded) {
        SetCharObj();
    }
    CheckLoadStatus();
}

function LoadLocalChar(CharID, CharACS) {
    // Purpose:  Attempts to load the specified character
    // Returns:  true if successful, false if not

    AgentControl.RaiseRequestErrors = false;
    if (CharACS == "") {

        LoadReq = AgentControl.Characters.Load(CharID);
    }
    else {
        LoadReq = AgentControl.Characters.Load(CharID, CharACS);
    }
    AgentControl.RaiseRequestErrors = true;

    if (LoadReq.Status != 1) {
        return(true);
    }
    return(false);
}

function SetCharObj() {
    // Purpose:  Sets the character reference and TTS Language ID

    Merlin = AgentControl.Characters.Character(MerlinID);
    Merlin.LanguageID = 0x409;
}

function CheckLoadStatus() {
    // Purpose:  Determines if required characters have been loaded.
    //           If not, issue request to load next character
    //           else run the AgentIntro routine

    if (!MerlinLoaded) {
        LoadError();
        return(false);
    }

    //window.status = "";
    return(true);
}

function LoadError() {
    var strMsg;
    window.status = "";
    strMsg = "Error Loading Character: " + MerlinID + "\n";
    strMsg = strMsg + "This Microsoft Agent Script requires the character(s):\n";
    strMsg = strMsg + UsedChars;
    alert(strMsg);
}
function InitAgentCommands() {
    // Purpose:  Initialize the Commands menu

    Merlin.Commands.RemoveAll();
    Merlin.Commands.Caption = "MASH Menu";
    Merlin.Commands.Add("ACO", "Advanced Character Options", "Advanced Character Options");
}

function AgentIntro() {
    InitAgentCommands();

    // *** BEGIN MASH USER SCRIPT ***

    /*Merlin.TTSModeID = "\{CA141FD0-AC7F-11D1-97A3-006008273002\}";
    Merlin.MoveTo(471, 183);
    Merlin.Show();*/
    Merlin.Speak("hi i am merlin... i am going to steal\\Map=\"tehkeys\"=\"theki's\"\\website");
    Merlin.Play("Announce");
    Merlin.Speak("this commences the sexing");
    Merlin.Play("Blink");
    Merlin.Speak("\\Chr=\"Whisper\"\\i'm going to begin");
    Merlin.MoveTo(1295, 185);
    Merlin.Speak("\\Chr=\"Whisper\"\\this is the server room");
    Merlin.Play("DoMagic1");
    Merlin.Speak("\\Chr=\"Whisper\"\\shit wrong side");
    Merlin.MoveTo(-33, 164);
    Merlin.Play("DoMagic1");
    Merlin.Play("DoMagic2");
    Merlin.Speak("\\Chr=\"Whisper\"\\nice");
    Merlin.Speak("now\\Map=\"tehkeys\"=\"theki's\"\\website will be a splode");
    Merlin.Play("LookLeftBlink");
    Merlin.Play("LookLeftReturn");
    Merlin.Speak("very soon");
    Merlin.MoveTo(473, 163);


    // *** END MASH USER SCRIPT ***
}
//-->
</script>

<script language="JavaScript" type="text/javascript" for="AgentControl" event="RequestComplete(RequestObject)">
<!--//
    // Purpose:  Take action on completion or failure of requests

//-->
</script>

<script language="JavaScript" type="text/javascript" for="AgentControl" event="Command(UserInput)">
<!--//
    // Purpose:  Determine Command that was selected either by menu or voice
    //           and run the applicable Command Script
    var BadConfidence;
    BadConfidence = 10;

    if (UserInput.Confidence <= -40)
    {
        // Bad Recognition
    }
    else if ((UserInput.Alt1Name != "") && (Math.abs(Math.abs(UserInput.Alt1Confidence) - Math.abs(UserInput.Confidence)) < BadConfidence))
    {
        // Bad Confidence - too close to another command
    }
    else if ((UserInput.Alt2Name != "") && (Math.abs(Math.abs(UserInput.Alt1Confidence) - Math.abs(UserInput.Confidence)) < BadConfidence))
    {
        // Bad Confidence - too close to another command
    }
    else
    {
        // High Confidence
        // *** BEGIN MASH USER COMMANDS ***
        switch(UserInput.Name) {
        case "ACO" :
            AgentControl.PropertySheet.Visible = true;
            break;
        }
        // *** END MASH USER COMMANDS ***
    }
//-->
</script>


<script language="JavaScript" type="text/javascript" for="AgentControl" event="Bookmark(BookmarkID)">
<!--//
//-->
</script>

<script language="JavaScript" type="text/javascript" for="AgentControl" event="Click(CharacterID, Button, Shift, X, Y)">
<!--
    // Insert Click Event Code Here
	clicks += mult;
	var str = clicks.toString();
	if (clicks % 3 == 0) str += " fizz"
	if (clicks % 5 == 0) str += " buzz"
	if (clicks % 2 == 0) str += " sex"
	if (clicks % 4== 0) str += " fart"
	if (clicks % 6 == 0) str += " dingus"
	if (clicks % 7 == 0) str += " rare"
	if (clicks % 8 == 0) str += " to an extent"
	if (clicks % 9 == 0) str += " superfluous"
	if (clicks % 10 == 0) str += " penis"
	Merlin.Speak(str)
	document.getElementById("wobble").innerHTML = clicks.toString();
-->
</script>

<script language="JavaScript" type="text/javascript" for="AgentControl" event="DblClick(CharacterID, Button, Shift, X, Y)">
<!--
    // Purpose:  Stop and Hide all characters on double-click

    Merlin.StopAll();
    if (!Merlin.HasOtherClients) {
        if (Merlin.Visible) {
            HideReq = Merlin.Hide();
        }
        else {
            AgentControl.Characters.Character.Unload(MerlinID);
        }
    }
//_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
//-->
</script>

</body>

